# 1.

Сформулируйте SQL запрос для создания таблицы book, занесите его в окно кода (расположено ниже)  и отправьте на
проверку (кнопка Отправить). Структура таблицы book:

| Поле    | Тип, описание                  |
|---------|--------------------------------|
| book_id | INT PRIMARY KEY AUTO_INCREMENT |
| title   | VARCHAR(50)                    |
| author  | VARCHAR(30)                    |
| price   | DECIMAL(8, 2)                  |
| amount  | INT                            |

```mysql
create table book
(
    book_id int primary key auto_increment,
    title   varchar(50),
    author  varchar(30),
    price   decimal(8, 2),
    amount  int
);
```

# 2.

Занесите новую строку в таблицу book (текстовые значения (тип VARCHAR) заключать либо в двойные, либо в одинарные
кавычки):

| book_id | title | author | price | amount |
|---------|-------|--------|-------|--------|

```mysql
insert into book (title, author, price, amount)
values ('Мастер и Маргарита', 'Булгаков М.А.', 670.99, 3);
```

# 3.

```mysql
insert into book (title, author, price, amount)
values ('Белая гвардия', 'Булгаков М.А.', 540.50, 5);
insert into book (title, author, price, amount)
values ('Идиот', 'Достоевский Ф.М.', 460.00, 10);
insert into book (title, author, price, amount)
values ('Братья Карамазовы', 'Достоевский Ф.М.', 799.01, 2);
```

# 4.

Вывести информацию о всех книгах, хранящихся на складе.

```mysql
select *
from book;
```

# 5.

Выбрать авторов, название книг и их цену из таблицы book.

```mysql
select author, title, price
from book;
```

# 6.

Выбрать названия книг и авторов из таблицы book, для поля title задать имя(псевдоним) Название, для поля author – Автор.

```mysql
select title  as Название,
       author as Автор
from book;
```

# 7. 

В конце года цену всех книг на складе пересчитывают – снижают ее на 30%. Написать SQL запрос, который из таблицы book выбирает названия, авторов, количества и вычисляет новые цены книг. Столбец с новой ценой назвать new_price, цену округлить до 2-х знаков после запятой.

```mysql
select title,
       author,
       amount,
       round(0.7 * price, 2) as new_price
from book;
```

# 8.

При анализе продаж книг выяснилось, что наибольшей популярностью пользуются книги Михаила Булгакова, на втором месте книги Сергея Есенина. Исходя из этого решили поднять цену книг Булгакова на 10%, а цену книг Есенина - на 5%. Написать запрос, куда включить автора, название книги и новую цену, последний столбец назвать new_price. Значение округлить до двух знаков после запятой.

```mysql
select author,
       title,
       round(if(author = 'Булгаков М.А.', price * 1.1, if(author = 'Есенин С.А.', price * 1.05, price)), 2) as new_price
from book;
```

# 9.

Вывести автора, название  и цены тех книг, количество которых меньше 10.

```mysql
select author,
       title,
       price
from book
where amount < 10;
```

# 10. 

Вывести название, автора,  цену  и количество всех книг, цена которых меньше 500 или больше 600, а стоимость всех экземпляров этих книг больше или равна 5000.

```mysql
select title,
       author,
       price,
       amount
from book
where (price < 500 or price > 600) and price * amount >= 5000;
```

# 11.

Вывести название и авторов тех книг, цены которых принадлежат интервалу от 540.50 до 800 (включая границы),  а количество или 2, или 3, или 5, или 7.

```mysql
select title,
       author
from book
where (price between 540.50 and 800) and amount in (2, 3, 5, 7);
```

# 12.

Вывести  автора и название  книг, количество которых принадлежит интервалу от 2 до 14 (включая границы). Информацию  отсортировать сначала по авторам (в обратном алфавитном порядке), а затем по названиям книг (по алфавиту).

```mysql
select author,
       title
from book
where amount between 2 and 14
order by author desc,
         title;
```

# 13.

Вывести название и автора тех книг, название которых состоит из двух и более слов, а инициалы автора содержат букву «С». Считать, что в названии слова отделяются друг от друга пробелами и не содержат знаков препинания, между фамилией автора и инициалами обязателен пробел, инициалы записываются без пробела в формате: буква, точка, буква, точка. Информацию отсортировать по названию книги в алфавитном порядке.

```mysql
select title,
       author
from book
where title like '_% %_' and author like '%С.%'
order by title;
```

# 14.

Отобрать различные (уникальные) элементы столбца amount таблицы book.

```mysql
select distinct amount
from book;
```

# 15.

Посчитать, количество различных книг и количество экземпляров книг каждого автора , хранящихся на складе.  Столбцы назвать Автор, Различных_книг и Количество_экземпляров

```mysql
select author as Автор, count(title) as Различных_книг, sum(amount) as Количество_экземпляров
from book
group by author;
```

# 16. 

Вывести фамилию и инициалы автора, минимальную, максимальную и среднюю цену книг каждого автора . Вычисляемые столбцы назвать Минимальная_цена, Максимальная_цена и Средняя_цена соответственно.

```mysql
select author, min(price) as Минимальная_цена, max(price) as Максимальная_цена, avg(price) as Средняя_цена
from book
group by author;
```

# 17.

Для каждого автора вычислить суммарную стоимость книг S (имя столбца Стоимость), а также вычислить налог на добавленную стоимость  для полученных сумм (имя столбца НДС ) , который включен в стоимость и составляет k = 18%,  а также стоимость книг  (Стоимость_без_НДС) без него. Значения округлить до двух знаков после запятой. В запросе для расчета НДС(tax)  и Стоимости без НДС(S_without_tax) использовать следующие формулы:

```math
tax = \frac{S \cdot \frac{k}{100}}{1 + \frac{k}{100}}

S_without_tax = \frac{S}{1 + \frac{k}{100}}
```

```mysql
select author, round(sum(price * amount), 2) as Стоимость, round(sum(price * amount) * 18 / 100 / (1 + 18 / 100), 2) as НДС, round(sum(price * amount) / (1 + 18 / 100), 2) as Стоимость_без_НДС
from book
group by author;
```

# 18.

Вывести  цену самой дешевой книги, цену самой дорогой и среднюю цену уникальных книг на складе. Названия столбцов Минимальная_цена, Максимальная_цена, Средняя_цена соответственно. Среднюю цену округлить до двух знаков после запятой.

Пояснение. В задании нужно посчитать среднюю цену уникальных книг на складе, а не среднюю цену всех экземпляров книг.

```mysql
select round(min(price), 2) as Минимальная_цена, round(max(price), 2) as Максимальная_цена, round(avg(price), 2) as Средняя_цена
from book;
```

# 19.

Вычислить среднюю цену и суммарную стоимость тех книг, количество экземпляров которых принадлежит интервалу от 5 до 14, включительно. Столбцы назвать Средняя_цена и Стоимость, значения округлить до 2-х знаков после запятой.

```mysql
select round(avg(price), 2) as Средняя_цена,
       round(sum(price * amount), 2) as Стоимость
from book
where amount between 5 and 14;
```

# 20.

Посчитать стоимость всех экземпляров каждого автора без учета книг «Идиот» и «Белая гвардия». В результат включить только тех авторов, у которых суммарная стоимость книг (без учета книг «Идиот» и «Белая гвардия») более 5000 руб. Вычисляемый столбец назвать Стоимость. Результат отсортировать по убыванию стоимости.

```mysql
select author,
       round(sum(price * amount), 2) as Стоимость
from book
where title <> 'Идиот' and title <> 'Белая гвардия'
group by author
having sum(price * amount) > 5000
order by Стоимость desc;
```




